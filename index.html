<!DOCTYPE html>
<html>
  <head>
    <title>test de l'api google sheet</title>
    <meta charset="utf-8" />
  </head>
  <body>
    <p>test de l'api google sheet</p>

    <!-- Ajouter des boutons pour initier la séquence d'autorisation et la déconnexion -->
    <button id="authorize_button" onclick="handleAuthClick()">Autoriser</button>
    <button id="signout_button" onclick="handleSignoutClick()">Deconnection</button>

    <pre id="content" style="white-space: pre-wrap;"></pre>

    <div id="result"></div> 
    <!-- Ajoute un élément HTML pour afficher le résultat -->

    <script type="text/javascript">
      // ici le code Java
      /* exported gapiLoaded */
      /* exported gisLoaded */
      /* exported handleAuthClick */
      /* exported handleSignoutClick */
      // peut-être que cela va résoudre le problème du gapi not define

      // Fonction pour vérifier l'accès à un sheet
      async function checkAccessToSheet() {
        try {
          const response = await gapi.client.sheets.spreadsheets.get({
            spreadsheetId: "1PMO8izJgB_U0yJXa13m7l_9yUWQtkV7LMajZdZ0tuyU",
          });

          // Mettez à jour le contenu de l'élément HTML avec le résultat
          const resultElement = document.getElementById('result');
          resultElement.innerHTML = 'Accès réussi à la feuille de calcul: ' + JSON.stringify(response);
        } catch (error) {
          // Mettez à jour le contenu de l'élément HTML avec le message d'erreur
          const resultElement = document.getElementById('result');
          resultElement.innerHTML = 'Erreur lors de la vérification de l\'accès à la feuille de calcul: ' + error.message;
        }
      }

      // Appeler la fonction checkAccessToSheet au chargement de la page
      document.addEventListener('DOMContentLoaded', checkAccessToSheet);
    </script>
    <script async defer src="https://apis.google.com/js/api.js" onload="gapiLoaded()"></script>
    <script async defer src="https://accounts.google.com/gsi/client" onload="gisLoaded()"></script>
  </body>
</html>
